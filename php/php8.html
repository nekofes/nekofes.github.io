<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script>
if(self!=top){top.location=self.location;}
</script>
<title>PHP MEMO</title>
<script type = "text/javascript" src="../o/run_prettify.js"></script>
<link href = "../o/prettify.css" type="text/css" rel="stylesheet" />
  <style>
    .prettyprint ol.linenums > li {
      list-style-type: decimal; 
    }
    /* お好みでボタンのスタイルも設定 */
    .copy-button {
      display: inline-block; /* インライン要素をブロック要素のように扱う */
      padding: 2px 5px; /* リンクテキストの周りに余白を追加 */
      border: 1px solid #000; /* 枠線を追加 */
      border-radius: 3px; /* 角を丸くする */
      text-decoration: none; /* デフォルトの下線を消す */
      color: #000; /* リンクの色 */
      background-color: #ffffcc; /* 背景色を黄色に */
      /* 蛍光ペン風の背景色 */
      /* background: linear-gradient(transparent 60%, #ffffcc 60%); */
    }
    .copy-button:hover {
      background-color: #ffeb99; /* ホバー時の背景色 */
    }

  </style>
</head>
<!--
<body oncontextmenu='return false;'>
<body>
-->
<body oncontextmenu='return false;'>
<table>
<tr>
<td>
<label class="toggle-switch">
  <input type="checkbox" id="toggle">
  <span class="slider"></span>
</label>
</td>
<td>
<p id="langText">現在の言語: 日本語</p>
</td>
</tr>
</table>
<!-- タイトル -->
<input type="hidden" id="lang" value="0">
<a id="n1" href='#' onClick="f2();">戻る</a>
<!--
<a href='#' onClick="f2();">back</a>
-->
<br>
<br>

<table>
	<tr>
		<td style="font-size:150%;font-width:bold;background-color:rgb(143 188 143 / 0.4);">
<div id="n2">URLチェック</div>
		</td>
	</tr>
	<tr>
<td>
<div id="n3">$_SERVER['HTTP_HOST']</div>
</td>
</tr>
</table>

<br>
<div id="n4">
$_SERVER['HTTP_HOST']を使用して<br>
クライアント(ブラウザ)が送信してきた情報が<br>
自サイトなのか？を判定する方法です。<br>
</div>
<br>
<div id="n5">
[サンプル]
</div>
<br>
<!-- jp -->
<div id=h1>
<a href="javascript:void(0);" id="copy1" class="copy-button" data-target="codeBlock1">copy</a>
<pre id="codeBlock1" class="prettyprint linenums;lang-js;">
$host = $_SERVER['HTTP_HOST'];
$checkURL = 'nekofes.github.io';

// ホスト名が特定の文字列で終わっているかチェックする
if (substr($host, -strlen($domain_to_check)) === $checkURL) 
{
	// ドメイン nekofes.github.io 内のアクセス
	echo "一致";
} 
else 
{
	// 異なるドメインからのアクセスである
	echo "不一致";
}
</pre>
</div>
<!-- en -->
<div id=h2>
<pre id="codeBlock2" class="prettyprint linenums;lang-js;">
$host = $_SERVER[‘HTTP_HOST’];
$checkURL = ‘nekofes.github.io’;

// Check if the hostname ends with a specific string
if (substr($host, -strlen($domain_to_check)) === $checkURL) 
{
    // Access within the domain nekofes.github.io
	echo “Match”;
} 
else 
{
    // Access from a different domain
    echo “No match”;
}
</pre>
<a href="javascript:void(0);" id="copy2" class="copy-button" data-target="codeBlock2">copy</a>
<pre id="codeBlock2" class="prettyprint linenums;lang-js;">
</pre>
</div>
<br>
<div id="n6">
$_SERVER['HTTP_HOST']<br>
クライアント（ブラウザ）から送信されたHTTPリクエストヘッダーの Host: フィールドの値を取得します。<br>
<div style="background-color:rgb(245 255 250 / 1.0);text-align:left;">
substr($host, -strlen($checkURL))
</div>
strlenを「-」(マイナス)にすることで<br>
ドメイン名が下から一致してるか？を判定します。<br>
<br>
<div style="background-color:rgb(245 255 250 / 1.0);text-align:left;">
if(strpos($_SERVER['HTTP_HOST'], "nekofes.github.io") === 0)
</div>
$_SERVER['HTTP_HOST'] が "nekofes.github.io" だった場合<br>
strpos("nekofes.github.io", "nekofes.github.io") は、<br>
先頭で見つかるため、0 === 0 となり、trueを返します。<br>
<br>
$_SERVER['HTTP_HOST'] が "www.nekofes.github.io" だった場合<br>
strpos("www.nekofes.github.io", "nekofes.github.io") を実行します。<br>
"test.co.jp" は "www." の直後、4文字目から始まります。<br>
したがって、4 を返します。<br>
4 === 0 となり、これは false です。<br>
<br>
$_SERVER['HTTP_HOST'] が "sub.nekofes.github.io" だった場合<br>
strpos("sub.nekofes.github.io", "nekofes.github.io") を実行します。<br>
これも同様に、"nekofes.github.io" は 4文字目 から始まります。4 を返します。<br>
4 === 0 となり、これは false です。
<br>
</div>
<br>
<br><br>
<a id="n7" href='#' onClick="f2();">戻る</a>

<br>
<br>
<!--  著作権情報 -->
<table style='background-color:rgba(220,220,220,255);color:black;text-align:center;'><tr><td style='background-color:rgba(198,198,255,255);color:black;text-align:center;'><b>著作権情報</b></td></tr><tr class=p2><td align=left >	ホームページおよびアプリ等に掲載されている情報等については、いかなる保障もいたしません。<br>ホームページおよびアプリ等を通じて入手したいかなる情報も複製、販売、出版または使用させたり、<br>または公開したりすることはできません。<br>当方は、ホームページおよびアプリ等を利用したいかなる理由によっての障害等が発生しても、<br>その結果ホームページおよびアプリ等を利用された本人または他の第三者が被った損害について<br>一切の責任を負わないものとします。<br></td></tr></table>

<style>
/* 薄い青色 */
.marker99ccff
{
    background-color: rgb(153 204 255 / 0.5);
}
/* darkseagreen */
.marker8fbc8f
{
    background-color: rgb(143 188 143 / 0.5);
}
/* gold */
.markerffd700
{
    background-color: rgb(255 215 0 / 0.5);
}
.frame {
	background-color: rgb(240 248 255 / 0.5); /* aliceblue */
	border: 3px solid rgb(30 144 255 / 1.00);    /* 1ピクセルの赤い実線枠 */
	padding: 5px;            /* 内側の余白 */
	margin: 10px;            /* 外側の余白 */
	margin-left:0px;
	word-break:break-all;
}

.toggle-switch {
	position: relative;
	display: inline-block;
	width: 60px;
	height: 34px;
}

.toggle-switch input {
	display: none;
}

.slider {
	position: absolute;
	cursor: pointer;
	top: 0; left: 0;
	right: 0; bottom: 0;
	background-color: lightgreen; /* japanese color */
	transition: 0.4s;
	border-radius: 34px;
}

.slider:before {
	position: absolute;
	content: "";
	height: 26px; width: 26px;
	left: 4px; bottom: 4px;
	background-color: white;
	transition: 0.4s;
	border-radius: 50%;
	content:"JP";
	text-align: center;
}

/* check（English） */
input:checked + .slider {
	background-color: lightblue; /* English color */
}

input:checked + .slider:before {
	transform: translateX(26px);
	content:"EN";
	text-align: center;
}
</style>
<!--
scriptタグのプログラムはボタンの最後に実装する必要があります。
-->
<script>
    // Clipboard API を利用したコピー処理
    function copyCodeById(targetId) {
      const codeElement = document.getElementById(targetId);
      if (!codeElement) {
        console.error("対象のコードブロックが見つかりません: " + targetId);
        return;
      }
      // コードブロック内のテキストを取得（タグ内の書式設定が不要な場合は innerText でOK）
      const codeText = codeElement.innerText;

      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(codeText)
          .then(() => {
            console.log("コピー成功");
          })
          .catch(err => {
            console.error("コピー中にエラーが発生しました:", err);
          });
      } else {
        console.error("Clipboard API はこのブラウザで利用できません");
      }
    }

    // 各コピーリンクに共通のイベントリスナーを設定
    document.querySelectorAll('.copy-button').forEach(function(button) {
      button.addEventListener('click', function() {
        const targetId = this.getAttribute('data-target');
        copyCodeById(targetId);
      });
    });
</script>
<script>
// グローバル変数
let lang = 0; // 0=日本語, 1=英語
let nextUrlPath="";
const text = {
  ja: {
n1:"戻る",
n2:"URLチェック",
n3:"$_SERVER['HTTP_HOST']",
n4:`
$_SERVER['HTTP_HOST']を使用して<br>
クライアント(ブラウザ)が送信してきた情報が<br>
自サイトなのか？を判定する方法です。<br>
`,
n5:`
[サンプル]
`,
n6:`
$_SERVER['HTTP_HOST']<br>
クライアント（ブラウザ）から送信されたHTTPリクエストヘッダーの Host: フィールドの値を取得します。<br>
<div style="background-color:rgb(245 255 250 / 1.0);text-align:left;">
substr($host, -strlen($checkURL))
</div>
strlenを「-」(マイナス)にすることで<br>
ドメイン名が下から一致してるか？を判定します。<br>
<br>
<div style="background-color:rgb(245 255 250 / 1.0);text-align:left;">
if(strpos($_SERVER['HTTP_HOST'], "nekofes.github.io") === 0)
</div>
$_SERVER['HTTP_HOST'] が "nekofes.github.io" だった場合<br>
strpos("nekofes.github.io", "nekofes.github.io") は、<br>
先頭で見つかるため、0 === 0 となり、trueを返します。<br>
<br>
$_SERVER['HTTP_HOST'] が "www.nekofes.github.io" だった場合<br>
strpos("www.nekofes.github.io", "nekofes.github.io") を実行します。<br>
"test.co.jp" は "www." の直後、4文字目から始まります。<br>
したがって、4 を返します。<br>
4 === 0 となり、これは false です。<br>
<br>
$_SERVER['HTTP_HOST'] が "sub.nekofes.github.io" だった場合<br>
strpos("sub.nekofes.github.io", "nekofes.github.io") を実行します。<br>
これも同様に、"nekofes.github.io" は 4文字目 から始まります。4 を返します。<br>
4 === 0 となり、これは false です。
<br>
`,
n7:"戻る",
  },
  en: {
n1: "back",
n2: "URL check",
n3: "$_SERVER['HTTP_HOST']",
n4: `
This method uses $_SERVER['HTTP_HOST'] to determine whether the information sent by the client (browser) is your own site. <br>
`,
n5: `
[Sample]
`,
n6: `
$_SERVER['HTTP_HOST']<br>
Retrieves the value of the Host: field in the HTTP request header sent by the client (browser). <br>
<div style="background-color:rgb(245 255 250 / 1.0);text-align:left;">
substr($host, -strlen($checkURL))
</div>
By setting strlen to "-" (minus), <br>
it determines whether the domain name matches from the bottom up. <br>
<br>
<div style="background-color:rgb(245 255 250 / 1.0);text-align:left;">
if(strpos($_SERVER['HTTP_HOST'], "nekofes.github.io") === 0)
</div>
If $_SERVER['HTTP_HOST'] is "nekofes.github.io",<br>
strpos("nekofes.github.io", "nekofes.github.io") is found at the beginning, so 0 === 0 and it returns true. <br>
<br>
If $_SERVER['HTTP_HOST'] is "www.nekofes.github.io",<br>
strpos("www.nekofes.github.io", "nekofes.github.io") is executed. <br>
"test.co.jp" starts from the fourth character, immediately after "www.". <br>
Therefore, it returns 4. <br>
4 === 0, which is false. <br>
<br>
If $_SERVER['HTTP_HOST'] is "sub.nekofes.github.io", <br>
Execute strpos("sub.nekofes.github.io", "nekofes.github.io") . <br>
Similarly, "nekofes.github.io" starts from the fourth character. It returns 4. <br>
4 === 0, which is false. <br>
`,
n7:"back",
}
};
function applyTextAll(lang, divIds) {
  divIds.forEach((id) => applyText(lang, id));
}

// (1) 取得：langとdivのidを渡してHTML文字列を返す
function getText(lang, divId) {
  // 言語がなければ日本語にフォールバック、該当idがなければ空文字
  return (text[lang] && text[lang][divId]) ?? (text.ja && text.ja[divId]) ?? '';
}
// (2) 反映：langとdivのidを渡してDOMに流し込む
function applyText(lang, divId) {
  const el = document.getElementById(divId);
  if (!el) return;
  el.innerHTML = getText(lang, divId);
}
//各説明
const ary = ["n1", "n2", "n3", "n4", "n5", "n6", "n7"];

document.addEventListener("DOMContentLoaded", () => {
	const toggle = document.getElementById("toggle");
	const hiddenLang = document.getElementById("lang");
	const langText = document.getElementById("langText");
	f4();
	toggle.addEventListener("change", () => {
		changeToggle();
	});
});
function changeToggle()
{
//console.log("function changeToggle()");
    const hiddenLang = document.getElementById("lang");
//console.log("hiddenLang:"+hiddenLang.value);
	if (toggle.checked) 
	{
//console.log("if (toggle.checked) ");
		// English
		hiddenLang.value = 1;
        lang=1;
		//langText.textContent = "current language: English";
	} 
	else 
	{
//console.log("else");
		// japanese
		hiddenLang.value = 0;
        lang=0;
		//langText.textContent = "現在の言語: 日本語";
	}
    displayLangText();
    //applyTextAll(lang==0?"jp":"en", ary);
    applyTextAll(lang==0?"ja":"en", ary);

//console.log("hidden value:", hiddenLang.value);
}
function displayLangText()
{
    const hiddenLang = document.getElementById("lang");
	if (hiddenLang.value == 0) 
	{
		// japanese
		langText.textContent = "現在の言語: 日本語";
	} 
	else 
	{
		// English
		langText.textContent = "current language: English";
	}

  // ここに f0(), f3() などの初期化処理を呼ぶ
    f3();
    f0();
    const obj=document.getElementById('lang');
//alert("lang:"+obj.value);
	if(obj.value==1)
	{
		toggle.checked=true;
        const hiddenLang = document.getElementById("lang");
		hiddenLang.value = 1;
        //20251102 mod end
        //20251103 comment out
        /*
		displayLangText();
        */
	}
    else
    {
		toggle.checked=false;
    }
}
function f1(value)
{
    const obj=document.getElementById('lang');
    obj.value=value;
    f0();
}
function f0()
{
    const obj=document.getElementById('lang');
    let lang=obj.value;
    //f4();
//console.log("lang:"+lang);
    //aaa
    //あとでもとに戻すこと
    //applyTextAll(lang==0?"jp":"en", ary);
    applyTextAll(lang==0?"ja":"en", ary);
	f4();

}
function f4()
{
    const obj=document.getElementById('lang');
    let lang=obj.value;
	//htmlとphpを言語切替
	const h1=document.getElementById('h1');//jp
	const h2=document.getElementById('h2');//en
	//const h3=document.getElementById('h3');//jp
	//const h4=document.getElementById('h4');//en
	if(lang==1)
	{
		h1.style.display="none";
		h2.style.display="block";
		//h3.style.display="none";
		//h4.style.display="block";
	}
	else
	{
		h1.style.display="block";
		h2.style.display="none";
		//h3.style.display="block";
		//h4.style.display="none";
	}

}
//aaa
function f3()
{
    let o1=new URL(window.location.href);
    let o2=o1.searchParams;
    let d=o2.get('lang');
    const hiddenLang = document.getElementById("lang");
    if(d==1||hiddenLang.value==1)
    {
        hiddenLang.value=1;
    }
    else
    {
        hiddenLang.value=0;
    }
}
function f2()
{
    const obj=document.getElementById('lang');
    let lang=obj.value;
/*
    let url="";
//alert("lang:"+lang);
    if(lang==0)
    {
        url='/php/index.html?lang=0';
    }
    else
    {
        url='/php/index.html?lang=1';
    }
*/
    window.location.href=urlPath();//url;
}
function urlPath()
{
	const obj=document.getElementById('lang');
	let lang=obj.value;
    nextUrlPath="/php/index.html";
	return nextUrlPath+"?lang=" + lang;
}
/*
//function urlPHP(no)
window.urlPHP = function(no)
{

//	const obj=document.getElementById('lang');
//	let lang=obj.value;
//	let url="";
//    nextUrlPath="/php/index.html";
//	url = nextUrlPath+"?lang=" + lang;

//alert("url:"+url);
//console.log("nextUrlPath:"+nextUrlPath);
//    saveAndNextPage(nextUrlPath);
	window.location.href=urlPath();//url;
};
*/
/*
//20251013 add sta
function saveAndNextPage(nextPath)
{
	sessionStorage.setItem('x', window.scrollX);
	sessionStorage.setItem('y', window.scrollY);
	sessionStorage.setItem('nextPath', nextUrlPath);
}
*/
</script>
</body>
</html>

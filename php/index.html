<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script>
if(self!=top){top.location=self.location;}
</script>
<title>PHP MEMO</title>
</head>
<!--
<body oncontextmenu='return false;'>
<body>
-->
<body oncontextmenu='return false;'>
<a href='#' onClick="f2();">back</a>
<table>
<tr>
<td>
<label class="toggle-switch">
  <input type="checkbox" id="toggle">
  <span class="slider"></span>
</label>
</td>
<td>
<p id="langText">現在の言語: 日本語</p>
</td>
</tr>
</table>
<!-- タイトル -->
<input type="hidden" id="lang" value="0">
<span class="marker99ccff" style="font-size:150%;font-wiight:bold;" id="nt0">
PHP メモ一覧
</span>

<!-- 引数関連 -->
<table class="frame">
<tr>
<td>
<span class="marker8fbc8f" style="font-size:120%;font-wiight:bold;" id="nt1">
引数関連
</span>
</td>
</tr>

<tr>
<td>
<span class="markerffd700" style="font-size:120%;">
<a href='#' onClick="urlPHP(1);" id="ng1">デフォルト値</a>
</span>
<div id="nd1">
メソッドの引数のデフォルト値にnullを設定することが禁止されています。
</div>
</td>
</tr>
</table>

<!-- Ajax関連 -->
<table class="frame">
<tr>
<td>
<span class="marker8fbc8f" style="font-size:120%;font-wiight:bold;" id="nt2">
Ajax関連
</span>
</td>
</tr>

<tr>
<td>
<span class="markerffd700" style="font-size:120%;">
<a href='#' onClick="urlPHP(2);" id="ng2">単純リクエスト</a>
</span>
<div id="nd2">
ajax
</div>
</td>
</tr>

<tr>
<td>
<span class="markerffd700" style="font-size:120%;">
<a href='#' onClick="urlPHP(3);" id="ng3">プリフライトリクエスト</a>
</span>
<div id="nd3">
ajax
</div>
</td>
</tr>

<tr>
<td>
<span class="markerffd700" style="font-size:120%;">
<a href='#' onClick="urlPHP(4);" id="ng4">入れ子になった配列データ</a>
</span>
<div id="nd4">
ajax
</div>
</td>
</tr>

<tr>
<td>
<span class="markerffd700" style="font-size:120%;">
<a href='#' onClick="urlPHP(5);" id="ng5">キー判定</a>
</span>
<div id="nd5">
ajax
</div>
</td>
</tr>

<tr>
<td>
<span class="markerffd700" style="font-size:120%;">
<a href='#' onClick="urlPHP(6);" id="ng6">get</a>
</span>
<div id="nd6">
ajax
</div>
</td>
</tr>

<tr>
<td>
<span class="markerffd700" style="font-size:120%;">
<a href='#' onClick="urlPHP(7);" id="ng7">ファイルアップロード</a>
</span>
<div id="nd7">
ajax
</div>
</td>
</tr>

</table>

<!-- チェック引数関連 -->
<table class="frame">
<tr>
<td>
<span class="marker8fbc8f" style="font-size:120%;font-wiight:bold;" id="nt3">
チェック関連
</span>
</td>
</tr>

<tr>
<td>
<span class="markerffd700" style="font-size:120%;">
<a href='#' onClick="urlPHP(8);" id="ng8">URLチェック</a>
</span>
<div id="nd8">
$_SERVER['HTTP_HOST']
</div>
</td>
</tr>
</table>

<br>
<a href='#' onClick="f2();">back</a>
<br>
<br>
<br>
<!--  著作権情報 -->
<table style='background-color:rgba(220,220,220,255);color:black;text-align:center;'><tr><td style='background-color:rgba(198,198,255,255);color:black;text-align:center;'><b>著作権情報</b></td></tr><tr class=p2><td align=left >	ホームページおよびアプリ等に掲載されている情報等については、いかなる保障もいたしません。<br>ホームページおよびアプリ等を通じて入手したいかなる情報も複製、販売、出版または使用させたり、<br>または公開したりすることはできません。<br>当方は、ホームページおよびアプリ等を利用したいかなる理由によっての障害等が発生しても、<br>その結果ホームページおよびアプリ等を利用された本人または他の第三者が被った損害について<br>一切の責任を負わないものとします。<br></td></tr></table>

<style>
/* 薄い青色 */
.marker99ccff
{
    background-color: rgb(153 204 255 / 0.5);
}
/* darkseagreen */
.marker8fbc8f
{
    background-color: rgb(143 188 143 / 0.5);
}
/* gold */
.markerffd700
{
    background-color: rgb(255 215 0 / 0.5);
}
.frame {
	background-color: rgb(240 248 255 / 0.5); /* aliceblue */
	border: 3px solid rgb(30 144 255 / 1.00);    /* 1ピクセルの赤い実線枠 */
	padding: 5px;            /* 内側の余白 */
	margin: 10px;            /* 外側の余白 */
	margin-left:0px;
	word-break:break-all;
}

.toggle-switch {
	position: relative;
	display: inline-block;
	width: 60px;
	height: 34px;
}

.toggle-switch input {
	display: none;
}

.slider {
	position: absolute;
	cursor: pointer;
	top: 0; left: 0;
	right: 0; bottom: 0;
	background-color: lightgreen; /* japanese color */
	transition: 0.4s;
	border-radius: 34px;
}

.slider:before {
	position: absolute;
	content: "";
	height: 26px; width: 26px;
	left: 4px; bottom: 4px;
	background-color: white;
	transition: 0.4s;
	border-radius: 50%;
	content:"JP";
	text-align: center;
}

/* check（English） */
input:checked + .slider {
	background-color: lightblue; /* English color */
}

input:checked + .slider:before {
	transform: translateX(26px);
	content:"EN";
	text-align: center;
}
</style>
<script>
// グローバル変数
let lang = 0; // 0=日本語, 1=英語
let nextUrlPath="";
window.addEventListener('pageshow', (event) => 
{
	//if (event.persisted) 
    // bfcache復元 or back/forward の場合
    if (event.persisted || performance.getEntriesByType('navigation')[0].type === 'back_forward') 
    {
        judgeURL();
	} 
	else 
	{
		const entries = performance.getEntriesByType('navigation');
		if (entries.length > 0) 
		{
			const navType = entries[0].type;
			if (navType === 'back_forward') 
			{
				//console.log('tap back or forward button. (except bfcache)');
				judgeURL();
                toggleRecheck();
			} 
			else if (navType === 'reload') 
			{
				//console.log('reload page');
			} 
			else if (navType === 'navigate') 
			{
				//console.log('normal navigation');
				judgeUrlBackLinkButton();
                toggleRecheck();
			}
		}
	}
});
function toggleRecheck()
{
    let o1=new URL(window.location.href);
    let o2=o1.searchParams;
    let d=o2.get('lang');
//console.log("function toggleRecheck() lang:"+d);//aaa
//alert("lang:"+d+" toggle.checkced:"+toggle.checked);
    if(d==0||d==null||(d==1&&toggle.checked===true))
    {
      toggle.checked=false;
    }
    else
    {
      toggle.checked=true;
    }
    displayLangText();
}
function judgeURL()
{
  const nextPath = sessionStorage.getItem('nextPath') ?? "";
  // 「自分が送り出した先」から戻ってきた場合のみ復元
  if (nextPath) {
      const x = sessionStorage.getItem('x') ?? 0;
      const y = sessionStorage.getItem('y') ?? 0;
      window.scrollTo(x, y);
  }
}
function judgeUrlBackLinkButton()
{
  const nextPath = sessionStorage.getItem('nextPath') ?? "";
  const state = history.state;
  if (state == null && location.pathname === "/php/index.html") 
  {
      //console.log("course in!!");
      const x = sessionStorage.getItem('x') ?? 0;
      const y = sessionStorage.getItem('y') ?? 0;
      window.scrollTo(x, y);
  }
  else
  {
    //console.log("not course in!!");
  }
}
//20251013 add end
const text = {
  ja: {
nt0:`
PHP メモ一覧
`,
nt1:`
引数関連
`,
nt2:`
Ajax関連
`,
nt3:`
チェック関連
`,
ng1:`
デフォルト値
`,
nd1:`
メソッドの引数のデフォルト値にnullを設定することが禁止されています。
`,
ng2:`
単純リクエスト
`,
nd2:`
ajax
`,
ng3:`
プリフライトリクエスト
Ajax
`,
nd3:`
ajax
`,
ng4:`
入れ子になった配列データ
`,
nd4:`
ajax
`,
ng5:`
キー判定
`,
nd5:`
ajax
`,
ng6:`
get
`,
nd6:`
ajax
`,
ng7:`
ファイルアップロード
`,
nd7:`
ajax
`,
ng8:`
URLチェック
`,
nd8:`
$_SERVER['HTTP_HOST']
`,
  },
  en: {
nt0:`
PHP Notes List
`,
nt1:`
argument-Related
`,
nt2:`
Ajax-Related
`,
nt3:`
check-Related
`,
ng1:`
default value
`,
nd1:`
It is now prohibited to set the default value of a method argument to null.
`,
ng2:`
Simple request
`,
nd2:`
ajax
`,
ng3:`
Preflight Request
Ajax
`,
nd3:`
ajax
`,
ng4:`
Nested array data
`,
nd4:`
ajax
`,
ng5:`
Key detection
`,
nd5:`
ajax
`,
ng6:`
get
`,
nd6:`
ajax
`,
ng7:`
File Upload
`,
nd7:`
ajax
`,
ng8:`
URL check
`,
nd8:`
$_SERVER['HTTP_HOST']
`,
}
};
function applyTextAll(lang, divIds) {
  divIds.forEach((id) => applyText(lang, id));
}

// (1) 取得：langとdivのidを渡してHTML文字列を返す
function getText(lang, divId) {
  // 言語がなければ日本語にフォールバック、該当idがなければ空文字
  return (text[lang] && text[lang][divId]) ?? (text.ja && text.ja[divId]) ?? '';
}
// (2) 反映：langとdivのidを渡してDOMに流し込む
function applyText(lang, divId) {
  const el = document.getElementById(divId);
  if (!el) return;
  el.innerHTML = getText(lang, divId);
}
//各説明
//const ary = ["n1", "n2", "n3", "n4", "n5", "n6", "n7"];
//const ary=["nt0","nt1","nt2","ng1","nd1"];

const ary=[
"nt0",
"nt1",
"nt2",
"ng1",
"nd1",
"ng2",
"nd2",
"ng3",
"nd3",
"ng4",
"nd4",
"ng5",
"nd5",
"ng6",
"nd6",
"ng7",
"nd7",
"ng8",
"nd8",
];
/*
document.addEventListener("load", (event) => {
alert("hiddenLang:"+hiddenLang);
	if(hiddenLang==0)
	{
		toggle.checked=false;
	}
	else
	{
		toggle.checked=true;
	}  

});
*/
document.addEventListener("DOMContentLoaded", () => {
	const toggle = document.getElementById("toggle");
//phpではこれでOKだったけど、jsではダメだった
//なのでdisplayLangText()の判定内でelseに追加した
//toggle.checked=false;
	const hiddenLang = document.getElementById("lang");
	const langText = document.getElementById("langText");
	
	toggle.addEventListener("change", () => {
		changeToggle();
	});
});
function changeToggle()
{
//console.log("function changeToggle()");
    const hiddenLang = document.getElementById("lang");
//console.log("hiddenLang:"+hiddenLang.value);
let d = document.getElementById("lang").value;
//alert("lang:"+d+" toggle.checkced:"+toggle.checked);
let flg=0;
	if(d==1 && toggle.checked===false)
	{
//console.log("course in!!");
		hiddenLang.value = 0;
        lang=0;
		//toggle.checked=false;
		flg=1;
	}
	else if (toggle.checked) 
	{
//console.log("if (toggle.checked) ");
		// English
		hiddenLang.value = 1;
        lang=1;
		//langText.textContent = "current language: English";
	} 
	else 
	{
//console.log("else");
		// japanese
		hiddenLang.value = 0;
        lang=0;
		//langText.textContent = "現在の言語: 日本語";
	}
    displayLangText();
    //applyTextAll(lang==0?"jp":"en", ary);
    applyTextAll(lang==0?"ja":"en", ary);
if(flg==1)
{
	toggle.checked=false;
}
//console.log("hidden value:", hiddenLang.value);
}
function displayLangText()
{
    const hiddenLang = document.getElementById("lang");
	if (hiddenLang.value == 0) 
	{
		// japanese
		langText.textContent = "現在の言語: 日本語";
	} 
	else 
	{
		// English
		langText.textContent = "current language: English";
	}

  // ここに f0(), f3() などの初期化処理を呼ぶ
    f3();
    f0();
    const obj=document.getElementById('lang');
//alert("lang:"+obj.value);
	if(obj.value==1)
	{
		toggle.checked=true;
        const hiddenLang = document.getElementById("lang");
		hiddenLang.value = 1;
        //20251102 mod end
        //20251103 comment out
        /*
		displayLangText();
        */
	}
    else
    {
		toggle.checked=false;
    }
}
function f1(value)
{
    const obj=document.getElementById('lang');
    obj.value=value;
    f0();
}
function f0()
{
    const obj=document.getElementById('lang');
    let lang=obj.value;
    //f4();
//console.log("lang:"+lang);
    //aaa
    //あとでもとに戻すこと
    //applyTextAll(lang==0?"jp":"en", ary);
    applyTextAll(lang==0?"ja":"en", ary);
}
//aaa
function f3()
{
    let o1=new URL(window.location.href);
    let o2=o1.searchParams;
    let d=o2.get('lang');
    const hiddenLang = document.getElementById("lang");
    if(d==1||hiddenLang.value==1)
    {
        hiddenLang.value=1;
    }
    else
    {
        hiddenLang.value=0;
    }
}
function f2()
{
    const obj=document.getElementById('lang');
    let lang=obj.value;
    let url="";
//alert("lang:"+lang);
    if(lang==0)
    {
        url='/index.html?lang=0';
    }
    else
    {
        url='/index.html?lang=1';
    }
    window.location.href=url;
}
//function urlPHP(no)
window.urlPHP = function(no)
{
	const obj=document.getElementById('lang');
	let lang=obj.value;
	let url="";
    nextUrlPath="/php/php" + no + ".html";
	url = nextUrlPath+"?lang=" + lang;
//alert("url:"+url);
//console.log("nextUrlPath:"+nextUrlPath);
    saveAndNextPage(nextUrlPath);
	window.location.href=url;
};
//20251013 add sta
function saveAndNextPage(nextPath)
{
	sessionStorage.setItem('x', window.scrollX);
	sessionStorage.setItem('y', window.scrollY);
	sessionStorage.setItem('nextPath', nextUrlPath);
}
</script>
</body>
</html>
